<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 Continuous Integration Workflow | Tercen developer’s guide</title>
<meta name="author" content="Tercen">
<meta name="description" content="10.1 General idea Everytime you push a new commit, a GitHub Workflow will be triggered. This workflow will build and push the Docker image containing the operator code and its execution...">
<meta name="generator" content="bookdown 0.41 with bs4_book()">
<meta property="og:title" content="Chapter 10 Continuous Integration Workflow | Tercen developer’s guide">
<meta property="og:type" content="book">
<meta property="og:description" content="10.1 General idea Everytime you push a new commit, a GitHub Workflow will be triggered. This workflow will build and push the Docker image containing the operator code and its execution...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 Continuous Integration Workflow | Tercen developer’s guide">
<meta name="twitter:description" content="10.1 General idea Everytime you push a new commit, a GitHub Workflow will be triggered. This workflow will build and push the Docker image containing the operator code and its execution...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Tercen developer’s guide</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction</a></li>
<li><a class="" href="guidelines.html"><span class="header-section-number">1</span> Guidelines</a></li>
<li class="book-part">Getting started</li>
<li><a class="" href="core-concepts.html"><span class="header-section-number">2</span> Core concepts</a></li>
<li><a class="" href="setting-up-tercen-studio.html"><span class="header-section-number">3</span> Setting up Tercen Studio</a></li>
<li class="book-part">R Operator development</li>
<li><a class="" href="general-workflow.html"><span class="header-section-number">4</span> General workflow</a></li>
<li><a class="" href="walkthrough-example-r-operator.html"><span class="header-section-number">5</span> Walkthrough example: R operator</a></li>
<li><a class="" href="deploying-an-r-operator.html"><span class="header-section-number">6</span> Deploying an R operator</a></li>
<li><a class="" href="improving-an-operator.html"><span class="header-section-number">7</span> Improving an operator</a></li>
<li class="book-part">Python Operator development</li>
<li><a class="" href="getting-familiar-with-tercen-studio.html"><span class="header-section-number">8</span> Getting familiar with Tercen Studio</a></li>
<li><a class="" href="developing-a-python-operator.html"><span class="header-section-number">9</span> Developing a Python Operator</a></li>
<li class="book-part">Advanced concepts</li>
<li><a class="active" href="continuous-integration-workflow.html"><span class="header-section-number">10</span> Continuous Integration Workflow</a></li>
<li><a class="" href="release-workflow.html"><span class="header-section-number">11</span> Release Workflow</a></li>
<li><a class="" href="installing-an-operator.html"><span class="header-section-number">12</span> Installing an Operator</a></li>
<li><a class="" href="common-patterns.html"><span class="header-section-number">13</span> Common patterns</a></li>
<li><a class="" href="advanced-patterns.html"><span class="header-section-number">14</span> Advanced patterns</a></li>
<li class="book-part">Templates</li>
<li><a class="" href="building-a-template.html"><span class="header-section-number">15</span> Building a template</a></li>
<li><a class="" href="updating-a-template.html"><span class="header-section-number">16</span> Updating a template</a></li>
<li class="book-part">Apps</li>
<li><a class="" href="building-an-app.html"><span class="header-section-number">17</span> Building an app</a></li>
<li class="book-part">Library</li>
<li><a class="" href="tercen-library.html"><span class="header-section-number">18</span> Tercen Library</a></li>
<li><a class="" href="custom-library.html"><span class="header-section-number">19</span> Custom library</a></li>
<li class="book-part">Best practices</li>
<li><a class="" href="naming.html"><span class="header-section-number">20</span> Development guidelines</a></li>
<li><a class="" href="tim.html"><span class="header-section-number">21</span> Using tim</a></li>
<li class="book-part">Troubleshooting</li>
<li><a class="" href="common-operator-issues.html"><span class="header-section-number">22</span> Common operator issues</a></li>
<li><a class="" href="ci-and-github-actions.html"><span class="header-section-number">23</span> CI and Github Actions</a></li>
<li class="book-part">Going forward</li>
<li><a class="" href="next-steps.html"><span class="header-section-number">24</span> Next steps</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="glossary.html">Glossary</a></li>
<li><a class="" href="organisation-setup.html">Organisation setup</a></li>
<li><a class="" href="tercen-studio.html">Tercen Studio</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="continuous-integration-workflow" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> Continuous Integration Workflow<a class="anchor" aria-label="anchor" href="#continuous-integration-workflow"><i class="fas fa-link"></i></a>
</h1>
<div id="general-idea" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> General idea<a class="anchor" aria-label="anchor" href="#general-idea"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Everytime you push a new commit, a GitHub Workflow will be triggered.</li>
<li>This workflow will build and push the Docker image containing the operator code and its execution environment .</li>
<li>This workflow is specified in a YAML file you can find in the <code>/.github/workflows</code> directory.</li>
<li>In this chapter, we will explain each section of the <code>/.github/workflows/ci.yaml</code> step-by-step to clarify its purpose and functionality.</li>
</ul>
</div>
<div id="workflow-name-and-trigger" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> 1. Workflow Name and Trigger<a class="anchor" aria-label="anchor" href="#workflow-name-and-trigger"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb31-1"><a href="continuous-integration-workflow.html#cb31-1" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> CI Workflow</span></span>
<span id="cb31-2"><a href="continuous-integration-workflow.html#cb31-2" tabindex="-1"></a></span>
<span id="cb31-3"><a href="continuous-integration-workflow.html#cb31-3" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb31-4"><a href="continuous-integration-workflow.html#cb31-4" tabindex="-1"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb31-5"><a href="continuous-integration-workflow.html#cb31-5" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">'main'</span><span class="kw">]</span></span></code></pre></div>
<p>The workflow is named <strong>CI Workflow</strong>, which is mainly for identification purposes within the GitHub Actions dashboard. The workflow is triggered by a <code>push</code> event, but only for the <code>main</code> branch. This means that every time code is pushed to the <code>main</code> branch of the repository, this workflow will automatically run.</p>
</div>
<div id="environment-variables" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> 2. Environment Variables<a class="anchor" aria-label="anchor" href="#environment-variables"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb32-1"><a href="continuous-integration-workflow.html#cb32-1" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb32-2"><a href="continuous-integration-workflow.html#cb32-2" tabindex="-1"></a><span class="at">  </span><span class="fu">REGISTRY</span><span class="kw">:</span><span class="at"> ghcr.io</span></span>
<span id="cb32-3"><a href="continuous-integration-workflow.html#cb32-3" tabindex="-1"></a><span class="at">  </span><span class="fu">IMAGE_NAME</span><span class="kw">:</span><span class="at"> ${{ github.repository }}</span></span></code></pre></div>
<p>Two environment variables are defined here:</p>
<ul>
<li><p><strong>REGISTRY</strong>: This is set to <code>ghcr.io</code>, which stands for <strong>GitHub Container Registry</strong>. It is the domain where the Docker images will be stored.</p></li>
<li><p><strong>IMAGE_NAME</strong>: This variable is dynamically set to the name of the GitHub repository using <code>github.repository</code>. The <code>${{ github.repository }}</code> syntax is GitHub’s way of accessing context values, such as the repository name.</p></li>
</ul>
<p>The image name will be used later when tagging the Docker image.</p>
</div>
<div id="job-definition-build-and-push-image" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> 3. Job Definition: <code>build-and-push-image</code><a class="anchor" aria-label="anchor" href="#job-definition-build-and-push-image"><i class="fas fa-link"></i></a>
</h2>
<p>The core of the workflow is defined within a single job called <code>build-and-push-image</code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb33-1"><a href="continuous-integration-workflow.html#cb33-1" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb33-2"><a href="continuous-integration-workflow.html#cb33-2" tabindex="-1"></a><span class="at">  </span><span class="fu">build-and-push-image</span><span class="kw">:</span></span>
<span id="cb33-3"><a href="continuous-integration-workflow.html#cb33-3" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb33-4"><a href="continuous-integration-workflow.html#cb33-4" tabindex="-1"></a><span class="at">    </span><span class="fu">permissions</span><span class="kw">:</span></span>
<span id="cb33-5"><a href="continuous-integration-workflow.html#cb33-5" tabindex="-1"></a><span class="at">      </span><span class="fu">contents</span><span class="kw">:</span><span class="at"> read</span></span>
<span id="cb33-6"><a href="continuous-integration-workflow.html#cb33-6" tabindex="-1"></a><span class="at">      </span><span class="fu">packages</span><span class="kw">:</span><span class="at"> write</span></span>
<span id="cb33-7"><a href="continuous-integration-workflow.html#cb33-7" tabindex="-1"></a><span class="at">      </span><span class="fu">attestations</span><span class="kw">:</span><span class="at"> write</span></span>
<span id="cb33-8"><a href="continuous-integration-workflow.html#cb33-8" tabindex="-1"></a><span class="at">      </span><span class="fu">id-token</span><span class="kw">:</span><span class="at"> write</span></span></code></pre></div>
<ul>
<li><p><strong>runs-on: ubuntu-latest</strong>: The job will run on the latest available version of Ubuntu. This provides a virtual machine with all the necessary tools to run Docker and interact with GitHub.</p></li>
<li>
<p><strong>permissions</strong>: This section grants specific permissions to the job:</p>
<ul>
<li>
<code>contents: read</code>: Allows reading the repository’s contents (code, files).</li>
<li>
<code>packages: write</code>: Allows publishing Docker images to GitHub Packages.</li>
<li>
<code>attestations: write</code>: Grants access to manage attestations, which are metadata related to builds.</li>
<li>
<code>id-token: write</code>: Allows the job to issue ID tokens for authentication, commonly used with OpenID Connect for secure token exchanges.</li>
</ul>
</li>
</ul>
</div>
<div id="steps-in-the-workflow" class="section level2" number="10.5">
<h2>
<span class="header-section-number">10.5</span> 4. Steps in the Workflow<a class="anchor" aria-label="anchor" href="#steps-in-the-workflow"><i class="fas fa-link"></i></a>
</h2>
<p>This job consists of several steps, each performing a crucial task in the workflow.</p>
<div id="step-1-checkout-repository" class="section level3" number="10.5.1">
<h3>
<span class="header-section-number">10.5.1</span> Step 1: Checkout Repository<a class="anchor" aria-label="anchor" href="#step-1-checkout-repository"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb34-1"><a href="continuous-integration-workflow.html#cb34-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Checkout repository</span></span>
<span id="cb34-2"><a href="continuous-integration-workflow.html#cb34-2" tabindex="-1"></a><span class="at">  </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v4</span></span></code></pre></div>
<p>The first step uses the <code>actions/checkout</code> action, version <code>v4</code>. This action checks out the repository code so that it can be accessed in the subsequent steps. Without this step, the job wouldn’t be able to access the files in the repository.</p>
</div>
<div id="step-2-log-in-to-the-container-registry" class="section level3" number="10.5.2">
<h3>
<span class="header-section-number">10.5.2</span> Step 2: Log in to the Container Registry<a class="anchor" aria-label="anchor" href="#step-2-log-in-to-the-container-registry"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb35-1"><a href="continuous-integration-workflow.html#cb35-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Log in to the Container registry</span></span>
<span id="cb35-2"><a href="continuous-integration-workflow.html#cb35-2" tabindex="-1"></a><span class="at">  </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> docker/login-action@v3.3.0</span></span>
<span id="cb35-3"><a href="continuous-integration-workflow.html#cb35-3" tabindex="-1"></a><span class="at">  </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb35-4"><a href="continuous-integration-workflow.html#cb35-4" tabindex="-1"></a><span class="at">    </span><span class="fu">registry</span><span class="kw">:</span><span class="at"> ${{ env.REGISTRY }}</span></span>
<span id="cb35-5"><a href="continuous-integration-workflow.html#cb35-5" tabindex="-1"></a><span class="at">    </span><span class="fu">username</span><span class="kw">:</span><span class="at"> ${{ github.actor }}</span></span>
<span id="cb35-6"><a href="continuous-integration-workflow.html#cb35-6" tabindex="-1"></a><span class="at">    </span><span class="fu">password</span><span class="kw">:</span><span class="at"> ${{ secrets.GITHUB_TOKEN }}</span></span></code></pre></div>
<p>In this step, the workflow logs into GitHub’s Container Registry (<code>ghcr.io</code>) using the <code>docker/login-action</code>. This action allows you to authenticate to a container registry, enabling the workflow to push Docker images.</p>
<ul>
<li>
<strong>registry</strong>: Set to the value of <code>${{ env.REGISTRY }}</code> (<code>ghcr.io</code>).</li>
<li>
<strong>username</strong>: Set to <code>${{ github.actor }}</code>, which represents the username of the person or bot that triggered the workflow.</li>
<li>
<strong>password</strong>: Set to <code>${{ secrets.GITHUB_TOKEN }}</code>, a built-in secret provided by GitHub to authenticate the workflow. This token allows the workflow to access the repository’s packages and perform the necessary actions.</li>
</ul>
</div>
<div id="step-3-extract-docker-metadata-tags-and-labels" class="section level3" number="10.5.3">
<h3>
<span class="header-section-number">10.5.3</span> Step 3: Extract Docker Metadata (Tags and Labels)<a class="anchor" aria-label="anchor" href="#step-3-extract-docker-metadata-tags-and-labels"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb36-1"><a href="continuous-integration-workflow.html#cb36-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Extract metadata (tags, labels) for Docker</span></span>
<span id="cb36-2"><a href="continuous-integration-workflow.html#cb36-2" tabindex="-1"></a><span class="at">  </span><span class="fu">id</span><span class="kw">:</span><span class="at"> meta</span></span>
<span id="cb36-3"><a href="continuous-integration-workflow.html#cb36-3" tabindex="-1"></a><span class="at">  </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> docker/metadata-action@v5.5.1</span></span>
<span id="cb36-4"><a href="continuous-integration-workflow.html#cb36-4" tabindex="-1"></a><span class="at">  </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb36-5"><a href="continuous-integration-workflow.html#cb36-5" tabindex="-1"></a><span class="at">    </span><span class="fu">images</span><span class="kw">:</span><span class="at"> ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}</span></span></code></pre></div>
<p>This step uses the <code>docker/metadata-action</code> to extract metadata (such as tags and labels) from the repository and build context. The extracted metadata will be used later when tagging the Docker image.</p>
<ul>
<li>
<strong>id: meta</strong>: This assigns an identifier <code>meta</code> to the step, making its outputs accessible in later steps.</li>
<li>
<strong>images</strong>: This specifies the base name for the Docker image, which is constructed from the container registry and the repository name.</li>
</ul>
<p>The output from this step is crucial for correctly tagging and labeling the Docker image in the next step.</p>
</div>
<div id="step-4-build-and-push-docker-image" class="section level3" number="10.5.4">
<h3>
<span class="header-section-number">10.5.4</span> Step 4: Build and Push Docker Image<a class="anchor" aria-label="anchor" href="#step-4-build-and-push-docker-image"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb37-1"><a href="continuous-integration-workflow.html#cb37-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Build and push Docker image</span></span>
<span id="cb37-2"><a href="continuous-integration-workflow.html#cb37-2" tabindex="-1"></a><span class="at">  </span><span class="fu">id</span><span class="kw">:</span><span class="at"> push</span></span>
<span id="cb37-3"><a href="continuous-integration-workflow.html#cb37-3" tabindex="-1"></a><span class="at">  </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> docker/build-push-action@v6.7.0</span></span>
<span id="cb37-4"><a href="continuous-integration-workflow.html#cb37-4" tabindex="-1"></a><span class="at">  </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb37-5"><a href="continuous-integration-workflow.html#cb37-5" tabindex="-1"></a><span class="at">    </span><span class="fu">context</span><span class="kw">:</span><span class="at"> .</span></span>
<span id="cb37-6"><a href="continuous-integration-workflow.html#cb37-6" tabindex="-1"></a><span class="at">    </span><span class="fu">push</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb37-7"><a href="continuous-integration-workflow.html#cb37-7" tabindex="-1"></a><span class="at">    </span><span class="fu">tags</span><span class="kw">:</span><span class="at"> ${{ steps.meta.outputs.tags }}</span></span>
<span id="cb37-8"><a href="continuous-integration-workflow.html#cb37-8" tabindex="-1"></a><span class="at">    </span><span class="fu">labels</span><span class="kw">:</span><span class="at"> ${{ steps.meta.outputs.labels }}</span></span></code></pre></div>
<p>In this final step, the <code>docker/build-push-action</code> is used to:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Build</strong> a Docker image using the repository’s <code>Dockerfile</code>.</li>
<li>
<strong>Push</strong> the built image to the GitHub Container Registry.</li>
</ol>
<p>Key parameters in this step:</p>
<ul>
<li>
<strong>context</strong>: Set to <code>.</code> (the current directory). This specifies the build context, meaning the files in the repository’s root directory will be used for the Docker build.</li>
<li>
<strong>push</strong>: Set to <code>true</code>. This ensures the Docker image is automatically pushed to the registry after it is built.</li>
<li>
<strong>tags</strong>: The tags for the image, provided by the output of the <code>meta</code> step (<code>${{ steps.meta.outputs.tags }}</code>).</li>
<li>
<strong>labels</strong>: Additional labels for the image, also provided by the <code>meta</code> step (<code>${{ steps.meta.outputs.labels }}</code>).</li>
</ul>
</div>
<div id="optional-personal-access-token" class="section level3" number="10.5.5">
<h3>
<span class="header-section-number">10.5.5</span> Optional: Personal Access Token<a class="anchor" aria-label="anchor" href="#optional-personal-access-token"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb38-1"><a href="continuous-integration-workflow.html#cb38-1" tabindex="-1"></a><span class="co"># A PAT is needed for this action, GITHUB_TOKEN cannot get relevant permission </span></span>
<span id="cb38-2"><a href="continuous-integration-workflow.html#cb38-2" tabindex="-1"></a><span class="co"># secrets: |</span></span>
<span id="cb38-3"><a href="continuous-integration-workflow.html#cb38-3" tabindex="-1"></a><span class="co">#   github_pat=${{ secrets.GH_PAT }}</span></span></code></pre></div>
<p>This is an optional comment explaining that if higher-level permissions are required, a Personal Access Token (PAT) should be used instead of the default <code>GITHUB_TOKEN</code>. This would be defined as a secret (<code>GH_PAT</code>).</p>
</div>
</div>
<div id="conclusion-1" class="section level2" number="10.6">
<h2>
<span class="header-section-number">10.6</span> Conclusion<a class="anchor" aria-label="anchor" href="#conclusion-1"><i class="fas fa-link"></i></a>
</h2>
<p>This CI pipeline builds and pushes Docker images to GitHub Container Registry every time changes are made to the <code>main</code> branch. The workflow:</p>
<ol style="list-style-type: decimal">
<li>Checks out the repository.</li>
<li>Logs into the container registry.</li>
<li>Extracts metadata to tag and label the image.</li>
<li>Builds and pushes the Docker image to the registry.</li>
</ol>
<p>By using GitHub Actions and Docker together, this workflow automates the process of containerizing code and storing it in a centralized registry, enabling future installation from Tercen.</p>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="developing-a-python-operator.html"><span class="header-section-number">9</span> Developing a Python Operator</a></div>
<div class="next"><a href="release-workflow.html"><span class="header-section-number">11</span> Release Workflow</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#continuous-integration-workflow"><span class="header-section-number">10</span> Continuous Integration Workflow</a></li>
<li><a class="nav-link" href="#general-idea"><span class="header-section-number">10.1</span> General idea</a></li>
<li><a class="nav-link" href="#workflow-name-and-trigger"><span class="header-section-number">10.2</span> 1. Workflow Name and Trigger</a></li>
<li><a class="nav-link" href="#environment-variables"><span class="header-section-number">10.3</span> 2. Environment Variables</a></li>
<li><a class="nav-link" href="#job-definition-build-and-push-image"><span class="header-section-number">10.4</span> 3. Job Definition: build-and-push-image</a></li>
<li>
<a class="nav-link" href="#steps-in-the-workflow"><span class="header-section-number">10.5</span> 4. Steps in the Workflow</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#step-1-checkout-repository"><span class="header-section-number">10.5.1</span> Step 1: Checkout Repository</a></li>
<li><a class="nav-link" href="#step-2-log-in-to-the-container-registry"><span class="header-section-number">10.5.2</span> Step 2: Log in to the Container Registry</a></li>
<li><a class="nav-link" href="#step-3-extract-docker-metadata-tags-and-labels"><span class="header-section-number">10.5.3</span> Step 3: Extract Docker Metadata (Tags and Labels)</a></li>
<li><a class="nav-link" href="#step-4-build-and-push-docker-image"><span class="header-section-number">10.5.4</span> Step 4: Build and Push Docker Image</a></li>
<li><a class="nav-link" href="#optional-personal-access-token"><span class="header-section-number">10.5.5</span> Optional: Personal Access Token</a></li>
</ul>
</li>
<li><a class="nav-link" href="#conclusion-1"><span class="header-section-number">10.6</span> Conclusion</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Tercen developer’s guide</strong>" was written by Tercen. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
