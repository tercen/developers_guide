<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Deploying an R operator | Tercen developer’s guide</title>
<meta name="author" content="Tercen">
<meta name="description" content="Now that we have a working R operator for Tercen, we want to deploy it! We will now document, prepare tests and release our linear regression operator. Documenting the operator Edit the README.md...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="Chapter 6 Deploying an R operator | Tercen developer’s guide">
<meta property="og:type" content="book">
<meta property="og:description" content="Now that we have a working R operator for Tercen, we want to deploy it! We will now document, prepare tests and release our linear regression operator. Documenting the operator Edit the README.md...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Deploying an R operator | Tercen developer’s guide">
<meta name="twitter:description" content="Now that we have a working R operator for Tercen, we want to deploy it! We will now document, prepare tests and release our linear regression operator. Documenting the operator Edit the README.md...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-105575395-1', 'auto');
      ga('send', 'pageview');

    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Tercen developer’s guide</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction</a></li>
<li><a class="" href="guidelines.html"><span class="header-section-number">1</span> Guidelines</a></li>
<li class="book-part">Getting started</li>
<li><a class="" href="core-concepts.html"><span class="header-section-number">2</span> Core concepts</a></li>
<li><a class="" href="setting-up-tercen-studio.html"><span class="header-section-number">3</span> Setting up Tercen Studio</a></li>
<li class="book-part">Operator development</li>
<li><a class="" href="general-workflow.html"><span class="header-section-number">4</span> General workflow</a></li>
<li><a class="" href="walkthrough-example-r-operator.html"><span class="header-section-number">5</span> Walkthrough example: R operator</a></li>
<li><a class="active" href="deploying-an-r-operator.html"><span class="header-section-number">6</span> Deploying an R operator</a></li>
<li><a class="" href="improving-an-operator.html"><span class="header-section-number">7</span> Improving an operator</a></li>
<li><a class="" href="creating-a-shiny-operator.html"><span class="header-section-number">8</span> Creating a shiny operator</a></li>
<li><a class="" href="creating-a-docker-operator.html"><span class="header-section-number">9</span> Creating a docker operator</a></li>
<li><a class="" href="continuous-integration.html"><span class="header-section-number">10</span> Continuous integration</a></li>
<li><a class="" href="common-patterns.html"><span class="header-section-number">11</span> Common patterns</a></li>
<li class="book-part">Templates</li>
<li><a class="" href="building-a-template.html"><span class="header-section-number">12</span> Building a template</a></li>
<li class="book-part">Apps</li>
<li><a class="" href="building-an-app.html"><span class="header-section-number">13</span> Building an app</a></li>
<li class="book-part">Going forward</li>
<li><a class="" href="naming.html"><span class="header-section-number">14</span> Development guidelines</a></li>
<li><a class="" href="next-steps.html"><span class="header-section-number">15</span> Next steps</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="glossary.html">Glossary</a></li>
<li><a class="" href="tercen-studio.html">Tercen Studio</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="deploying-an-r-operator" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Deploying an R operator<a class="anchor" aria-label="anchor" href="#deploying-an-r-operator"><i class="fas fa-link"></i></a>
</h1>
<p>Now that we have a working R operator for Tercen, we want to deploy it! We will now document, prepare tests and release our <strong>linear regression</strong> operator.</p>
<div id="documenting-the-operator" class="section level2 unnumbered">
<h2>Documenting the operator<a class="anchor" aria-label="anchor" href="#documenting-the-operator"><i class="fas fa-link"></i></a>
</h2>
<p>Edit the <code>README.md</code> to describe the operator design and usage. The documentation should contain:</p>
<ul>
<li><p>A <strong>general description</strong> of the operator</p></li>
<li><p>A description of the <strong>input projections</strong></p></li>
<li><p>A description of the <strong>output relations</strong></p></li>
</ul>
<p>For example, here is how the <code>lm</code> operator documentation looks:</p>
<p><strong>Description</strong></p>
<p>The <code>lm</code> operator performs a linear regression in Tercen.</p>
<p><strong>Usage</strong></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">Input projection</th>
<th align="left"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>y-axis</code></td>
<td align="left">measurement value</td>
</tr>
<tr class="even">
<td align="left"><code>x-axis</code></td>
<td align="left">explanatory value</td>
</tr>
</tbody>
</table></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">Output relations</th>
<th align="left"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>intercept</code></td>
<td align="left">numeric, intercept of the linear regression, per cell</td>
</tr>
<tr class="even">
<td align="left"><code>slope</code></td>
<td align="left">numeric, slope of the linear regression, per cell</td>
</tr>
</tbody>
</table></div>
<p><strong>Details</strong></p>
<p>The <code>lm</code> operator performs a linear regression on each cell and returns the slope and intercept of the model.</p>
</div>
<div id="deploy-1" class="section level2 unnumbered">
<h2>Deploy!<a class="anchor" aria-label="anchor" href="#deploy-1"><i class="fas fa-link"></i></a>
</h2>
<p><strong>1. Copy the code to the main.R script</strong></p>
<p>Once you are confident enough that your operator is working after testing it locally, you can copy the code to the <code>main.R</code> file.</p>
<p>Make sure not to include the <code><a href="https://rdrr.io/r/base/options.html">options()</a></code> calls that are only needed during the local development step:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The following lines shall not be included into main.R:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"tercen.workflowId"</span> <span class="op">=</span> <span class="st">"wwww"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"tercen.stepId"</span>     <span class="op">=</span> <span class="st">"dddd"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">getOption</a></span><span class="op">(</span><span class="st">"tercen.workflowId"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">getOption</a></span><span class="op">(</span><span class="st">"tercen.stepId"</span><span class="op">)</span></span></code></pre></div>
<p><strong>2. Initiate renv</strong></p>
<p>The ability to run an operator with exactly the same packages you used when you developed is essential for reproducible science. In order to ensure reproducibility, you can associate packages and their versions to your operator by using the <code>init()</code> function of the <code>renv</code> package:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/renv/reference/init.html">init</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This will initiate a project-local environment with a private R library in the <code>renv</code> subdirectory.</p>
<p><strong>3. Push it to your GitHub repository</strong></p>
<p>Once everything is ready, you simply need to push all the modifications to the GitHub repository that you created before.</p>
<p>If you want to install it directly from <code>Tercen</code>, you will need to <a href="https://help.github.com/en/github/administering-a-repository/managing-releases-in-a-repository">create a release in GitHub</a>.</p>
<p><strong>4. Notify community</strong></p>
<p>Currently, we ask you to send an email to <a href="mailto:support@tercen.com" class="email">support@tercen.com</a> containing the description and link to the <strong>operators app</strong> git repository, Tercen support will manually test it and add it to the <strong>app-library</strong> and thus allowing others to access it. We are currently building an web entry point for researchers to browse all the apps offered by the community.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="walkthrough-example-r-operator.html"><span class="header-section-number">5</span> Walkthrough example: R operator</a></div>
<div class="next"><a href="improving-an-operator.html"><span class="header-section-number">7</span> Improving an operator</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#deploying-an-r-operator"><span class="header-section-number">6</span> Deploying an R operator</a></li>
<li><a class="nav-link" href="#documenting-the-operator">Documenting the operator</a></li>
<li><a class="nav-link" href="#deploy-1">Deploy!</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Tercen developer’s guide</strong>" was written by Tercen. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
